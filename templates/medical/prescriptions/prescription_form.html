<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Recetas M√©dicas - Hospital San Jos√©</title>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Signature Pad -->
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

    <link rel="stylesheet" href="/static/css/prescription.css">
</head>
<body>
    <div class="container">
        <!-- üî• HEADER HOSPITALARIO PERFECTO - 2 FILAS -->
        <div class="header">
            <!-- PRIMERA FILA: Hospital + Receta (SIEMPRE 2 COLUMNAS) -->
            <div class="header-main">
                <div class="hospital-info">
                    <h1><i class="fas fa-hospital"></i> Hospital San Jos√©</h1>
                    <p>Av. Hospitales 123</p>
                    <p>Tel√©f. 01-2016500</p>
                </div>
                <div class="document-info">
                    <div class="prescription-type">RECETA M√âDICA</div>
                    <div class="prescription-id">N¬∞ REC20241210001</div>
                    <div class="prescription-date">12/6/2025</div>
                </div>
            </div>
            
            <!-- SEGUNDA FILA: Bot√≥n Volver (1/3 del ancho, alineado derecha) -->
            <div class="header-actions">
                <a href="#" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Volver
                </a>
            </div>
        </div>

        <!-- Datos Completos del Paciente -->
        <div class="patient-complete-data">
            <table class="patient-data-table">
                <tr>
                    <td class="label">PACIENTE:</td>
                    <td class="value">Silvia Ben√≠tez Luna</td>
                    <td class="label">HC:</td>
                    <td class="value">HC012</td>
                </tr>
                <tr>
                    <td class="label">EDAD:</td>
                    <td class="value">62 a√±os</td>
                    <td class="label">SEXO:</td>
                    <td class="value">Femenino</td>
                </tr>
                <tr>
                    <td class="label">CAMA:</td>
                    <td class="value">01E-101A</td>
                    <td class="label">SERVICIO:</td>
                    <td class="value">Medicina General</td>
                </tr>
                <tr>
                    <td class="label">DIAGN√ìSTICO:</td>
                    <td class="value" colspan="3">C√°ncer de mama no especificado</td>
                </tr>
            </table>
        </div>

        <!-- Signos Vitales Actuales -->
        <div class="current-vitals">
            <h4><i class="fas fa-heartbeat"></i> SIGNOS VITALES ACTUALES - 04:28</h4>
            <div class="vitals-row">
                <span>PA: 140/90 mmHg</span>
                <span>FC: 78 lpm</span>
                <span>FR: 18 rpm</span>
                <span>T¬∞: 36.8¬∞C</span>
                <span>SpO2: 98%</span>
            </div>
        </div>

        <!-- Navegaci√≥n por Tabs -->
        <div class="actions-section">
            <div class="action-tabs">
                <button class="action-tab active" onclick="newPrescription()">
                    <i class="fas fa-plus-circle"></i> Nueva Receta
                </button>
                <button class="action-tab" onclick="openViewRecipesModal()">
                    <i class="fas fa-search"></i> Ver Recetas
                </button>
                <button class="action-tab btn-success" onclick="savePrescription()" disabled id="saveTabBtn">
                    <i class="fas fa-save"></i> Guardar
                </button>
            </div>
        </div>

        <!-- Secci√≥n Principal: Medicamentos -->
        <div class="section" style="min-height: 400px;">
            <div class="section-title">
                <span><i class="fas fa-pills"></i> Buscar y agregar medicamento </span>
            </div>

            <!-- B√∫squeda de Medicamentos -->
            <div class="form-group">
                <div class="med-search">
                    <input type="text" id="searchMed" placeholder="Buscar medicamento por nombre o principio activo...">
                    <div class="med-results" id="medResults"></div>
                </div>
            </div>

            <!-- Estado Vac√≠o -->
            <div id="emptyState" class="empty-state" style="min-height: 250px;">
                <i class="fas fa-pills fa-4x"></i>
                <p style="margin: 16px 0 8px 0; font-size: 16px;">No hay medicamentos agregados</p>
                <p><small>Use el buscador para agregar medicamentos a la receta</small></p>
            </div>

            <!-- Tabla para Desktop -->
            <table class="medications-table" id="medicationsTable" style="display: none;">
                <thead>
                    <tr>
                        <th style="width: 80px;">C√ìDIGO</th>
                        <th>MEDICAMENTO</th>
                        <th style="width: 60px; text-align: center;">CT</th>
                        <th style="width: 280px;">POSOLOG√çA</th>
                        <th style="width: 120px; text-align: center;">ACCIONES</th>
                    </tr>
                </thead>
                <tbody id="medicationsTableBody">
                    <!-- Los medicamentos se agregan din√°micamente aqu√≠ -->
                </tbody>
            </table>

            <!-- Cards para M√≥vil -->
            <div class="medications-cards" id="medicationsCards">
                <!-- Las cards se agregan din√°micamente aqu√≠ -->
            </div>
        </div>

        <!-- SECCI√ìN FIRMA DIGITAL -->
        <div class="signature-section" id="signatureSection">
            <div class="signature-container" id="signatureContainer">
                <div class="signature-content">
                    <!-- Informaci√≥n del M√©dico -->
                    <div class="doctor-info-section">
                        <div class="doctor-details">
                            <div><strong>M√âDICO:</strong> Dr. Iker Cairampoma</div>
                            <div><strong>CMP:</strong> 1234</div>
                            <div><strong>ESPECIALIDAD:</strong> Cardiolog√≠a</div>
                            <div><strong>FECHA:</strong> 12/06/2025</div>
                            <div><strong>HORA:</strong> 04:35 a.m.</div>
                        </div>
                    </div>
                    
                    <!-- √Årea de Firma -->
                    <div class="signature-area">
                        <div class="signature-canvas-container" id="signatureCanvasContainer">
                            <canvas id="signaturePad" class="signature-pad" width="280" height="100"></canvas>
                            <div class="signature-placeholder" id="signaturePlaceholder">
                                <i class="fas fa-signature" style="font-size: 18px; opacity: 0.3; margin-bottom: 5px; display: block;"></i>
                                Haga clic y firme aqu√≠
                            </div>
                        </div>
                        
                        <div class="signature-actions">
                            <button class="signature-btn clear" onclick="clearSignature()" id="clearSignatureBtn">
                                <i class="fas fa-eraser"></i> Limpiar
                            </button>
                            <button class="signature-btn preview" onclick="previewPrescription()" id="previewBtn">
                                <i class="fas fa-eye"></i> Previsualizar
                            </button>
                            <button class="signature-btn print" onclick="printPrescription()" id="printBtn">
                                <i class="fas fa-print"></i> Imprimir
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/prescription.js"></script>
</body>
</html>